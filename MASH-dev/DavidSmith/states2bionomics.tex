\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={From State Transitions and Waiting Times to Bionomics},
            pdfauthor={David L Smith},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{From State Transitions and Waiting Times to Bionomics}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{David L Smith}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{6/8/2018}


\begin{document}
\maketitle

\hypertarget{background}{%
\subsection{Background}\label{background}}

Under some restricted conditions on waiting times, MBITES is what we
would get if we translated MBITES into a stochastic model, under the
Gillespie algorithm. We can, therefore, use MBDETES to compute
expectations for MBITES under these same contitions.

The utility \textbf{mbites2mbdetes} outputs state transitions as
described in the following.

\begin{itemize}
\tightlist
\item
  Let \(0\leq P_{X,Y}\leq 1\) denote the probability of making a
  transition from state \(X\) to state \(Y\) after one bout
\item
  The probability of dying, \(0 \leq P_{X,D} \leq 1\) must satifsy the
  condition \[\sum_{Y\neq D}P_{X,Y} =1-P_{X,D}.\]
\item
  Since there is the probability of repeating a state, we must compute
  the probability of making a transition out of the state and ending up
  alive and in a new state. We let this quantity be \(\Psi_{X,Y}\).
\item
  Let \(T_{X}\) the average time spent in a bout of type \(X\).
\item
  Let \(T_{X,Y}\) denote the expected waiting time to make the
  transition from \(X\) to \(Y\).
\end{itemize}

In some sense, we can rewrite MBDETES as a conservation equation in the
following way:
\[\left[ \begin{array}{c}dF/dt \\ dB/dt \\ dR/dt \\ dL/dt \\ dO/dt \\ dD/dt\end{array}\right]=
\left[ \begin{array}{ccccc}
P_{F,F}-1 & P_{F,B} & 0& 0 & 0 & P_{F,D} \\
P_{B,F} & P_{B,B}-1 & P_{B,R} & 0 &0 & P_{B,D} \\
P_{R,F} & P_{R,B} & -1 & P_{R,L} & P_{R,O}& P_{R,D} \\
0 & 0 & 0 & P_{L,L}-1& P_{L,O} & P_{L,D} \\
P_{O,F} & P_{O,B} & 0 & P_{O,L} & P_{O,O}-1 & P_{O,D} \\
P_{F,D} & P_{B,D} & P_{R,D} & P_{L,D} & P_{O,D} & 0
\end{array}\right] \left[ \begin{array}{c}F/t_F\\B/t_B\\R/t_R\\L/t_R\\O/t_O \\D   \\ \end{array}\right]
\]

\hypertarget{with-search}{%
\subsubsection{With Search}\label{with-search}}

With search, we can consider these same paths from \(R\) back to \(R\)
but with the more complicated problem of having repeated attempts to
search before successfully completing an attempt.

\hypertarget{transitions-from-f-to-b}{%
\paragraph{\texorpdfstring{\emph{Transitions from F to
B}}{Transitions from F to B}}\label{transitions-from-f-to-b}}

The state transitions from \(F\) are \(F\rightarrow {F,B,D}\), The
overall probability of going from \(F\) to \(B\) can be computed in two
ways.

One way of deriving the formula is by solving the infinite geometric
series.
\[\Psi_{F,B} = P_{F,B} + P_{F,F} P_{F,B} + P_{F,F}^2 P_{F,B} + \ldots = \frac{P_{F,B}}{1-P_{F,F}}\]

The other is by simply solving the recursion relationship:
\[\Psi_{F,B} = P_{F,B} + P_{F,F} \Psi_{F,B} = \frac{P_{F,B}}{1-P_{F,F}}\]
While the following derivations can be done in several different ways,
we use the second method, in part, because it is more concise.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Psi_FB =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{P_FB}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_FF)\})\}}
\end{Highlighting}
\end{Shaded}

Similarly, the waiting time is:
\[T_{F,B} =  T_F + P_{F,F} T_{F,B} = \frac{T_F}{1-P_{F,F}}\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_FB =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{tF}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_FF)\})\}}
\end{Highlighting}
\end{Shaded}

Similarly, the probability of dying is:
\[\Psi_{F,D} = \frac{P_{F,D}}{(1-P_{F,F})}.\] The expected waiting time
to die is (similarly): \[T_{F,D} = \frac{T_F}{(1-P_{F,F})}.\] \#\#\#\#
\emph{Transitions from B to R}

The transitions from \(B\) are \(B\rightarrow {F,B,R,D}\). The overall
probability of going from \(B\) to \(R\) is:
\[\Psi_{B,R} = P_{B,R} + \left(P_{B,B} + P_{B,F} \Psi_{F,B} \right) \Psi_{B,R}\]

which gives us:

\[ \Psi_{B,R} = \frac{P_{B,R}}{1-P_{B,B} - P_{B,F} \Psi_{F,B}} \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Psi_BR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  P_BR}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_BB}\OperatorTok{-}\NormalTok{P_BF}\OperatorTok{*}\KeywordTok{Psi_FB}\NormalTok{(PAR))}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

and: \[
T_{B,R} = T_B + P_{B,B} T_{B,R} + P_{B,F} \Psi_{F,B} \left(T_{F,B} +  T_{B,R} \right) =  \frac{T_B +  P_{B,F} \Psi_{F,B} T_{F,B}}{1-P_{B,B} - P_{B,F} \Psi_{F,B}}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_BR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  (tB}\OperatorTok{+}\NormalTok{P_BF}\OperatorTok{*}\KeywordTok{Psi_FB}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{T_FB}\NormalTok{(PAR))}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_BB}\OperatorTok{-}\NormalTok{P_BF}\OperatorTok{*}\KeywordTok{Psi_FB}\NormalTok{(PAR))}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{transitions-from-f-to-r}{%
\paragraph{\texorpdfstring{\emph{Transitions from F to
R}}{Transitions from F to R}}\label{transitions-from-f-to-r}}

The logic is such that the time from \(B\) to \(R\) includes the loop
back into \(F\), so the time from \(F\) to \(R\) is simply the sum of
the two times:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_FR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{T_FB}\NormalTok{(PAR) }\OperatorTok{+}\StringTok{ }\KeywordTok{T_BR}\NormalTok{(PAR)}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{transitions-from-l-to-o}{%
\paragraph{\texorpdfstring{\emph{Transitions from L to
O}}{Transitions from L to O}}\label{transitions-from-l-to-o}}

Similarly, the state transitions from \(L\) are
\(L \rightarrow {L,O,D}\), and from \(O\) are
\(B\rightarrow {F,L,O,B,D}\).

The overall probability of going from \(L\) to \(O\) is: \[
\Psi_{L,O}= P_{L,O} + P_{L,L} \Psi_{L,O} = \frac{P_{L,O}}{1-P_{L,L}}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Psi_LO =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  P_LO}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_LL)}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

The waiting time is:
\[T_{L,O}  = T_L + P_{L,L} T_{L,O} = \frac{T_L}{1-P_{L,L}} \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_LO =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  tL}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_LL)}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{transitions-from-o-to-fb}{%
\paragraph{\texorpdfstring{\emph{Transitions from O to
F/B}}{Transitions from O to F/B}}\label{transitions-from-o-to-fb}}

The probability of going from \(O\) to \(F\) or \(B\) is:
\[\Psi_{O,F|B} = P_{O,F} + P_{O,B} + \left(P_{O,O} + P_{O,L} \Psi_{L,O} \right) \Psi_{O,F|B} \]

\[ \Psi_{O,F|B} = \frac{P_{O,F}+ P_{O,B}}{1-P_{O,O} - P_{O,L} \Psi_{L,O}}.\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Psi_OF =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  P_OF}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_OO}\OperatorTok{-}\NormalTok{P_OL}\OperatorTok{*}\KeywordTok{Psi_LO}\NormalTok{(PAR))}
\NormalTok{\})\}}

\NormalTok{Psi_OB =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  P_OB}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_OO}\OperatorTok{-}\NormalTok{P_OL}\OperatorTok{*}\KeywordTok{Psi_LO}\NormalTok{(PAR))}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

and: \[
T_{O,F|B} = T_O + P_{O,O} T_{O,F|B} + P_{O,L} \Psi_{L,O} \left(T_L + T_{O,F|B} \right)
\]

\[
T_{O,F|B}= \frac{T_O  + P_{O,L} \Psi_{L,O} T_{L,O}}{1 - P_{O,O} - P_{O,L} \Psi_{L,O}}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_OFB =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  (tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_OL}\OperatorTok{*}\KeywordTok{Psi_LO}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{T_LO}\NormalTok{(PAR))}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_OO}\OperatorTok{-}\NormalTok{P_OL}\OperatorTok{*}\KeywordTok{Psi_LO}\NormalTok{(PAR))}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{the-length-of-a-feeding-cycle}{%
\subsubsection{The Length of a Feeding
Cycle}\label{the-length-of-a-feeding-cycle}}

Survival through a full feeding cycle is:
\[\Psi_{R,R} = \sum_{X \neq \left\{R,D\right\}} P_{R,X} \Psi_{X,R}\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Psi_FR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{Psi_FB}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{Psi_BR}\NormalTok{(PAR)}
\NormalTok{\})\}}

\NormalTok{Psi_OR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{Psi_OF}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{Psi_FR}\NormalTok{(PAR)}\OperatorTok{+}\KeywordTok{Psi_OB}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{Psi_BR}\NormalTok{(PAR)}
\NormalTok{\})\}}

\NormalTok{Psi_LR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{Psi_LO}\NormalTok{(PAR)}\OperatorTok{*}\KeywordTok{Psi_OR}\NormalTok{(PAR)}
\NormalTok{\})\}}

\NormalTok{Psi_RR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  P_RF}\OperatorTok{*}\KeywordTok{Psi_FR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RB}\OperatorTok{*}\KeywordTok{Psi_BR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RL}\OperatorTok{*}\KeywordTok{Psi_LR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RO}\OperatorTok{*}\KeywordTok{Psi_OR}\NormalTok{(PAR)}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

The average length of a feeding cycle is:
\[T_{R,R} = \sum_{X \neq \left\{R,D\right\}} P_{R,X} \Psi_{X,R} T_{X,R} \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_OR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{T_OFB}\NormalTok{(PAR) }\OperatorTok{+}\StringTok{ }\NormalTok{P_OB}\OperatorTok{/}\NormalTok{(P_OB}\OperatorTok{+}\NormalTok{P_OF)}\OperatorTok{*}\KeywordTok{T_BR}\NormalTok{(PAR)}\OperatorTok{+}\StringTok{ }\NormalTok{P_OF}\OperatorTok{/}\NormalTok{(P_OB}\OperatorTok{+}\NormalTok{P_OF)}\OperatorTok{*}\KeywordTok{T_FR}\NormalTok{(PAR)}
\NormalTok{\})\}}

\NormalTok{T_LR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
  \KeywordTok{T_LO}\NormalTok{(PAR) }\OperatorTok{+}\StringTok{ }\KeywordTok{T_OR}\NormalTok{(PAR)}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T_RR =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR)\{}\KeywordTok{with}\NormalTok{(PAR,\{}
\NormalTok{  (tR }\OperatorTok{+}
\StringTok{  }\NormalTok{P_RF}\OperatorTok{*}\KeywordTok{T_FR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RB}\OperatorTok{*}\KeywordTok{T_BR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RL}\OperatorTok{*}\KeywordTok{T_LR}\NormalTok{(PAR)}\OperatorTok{+}
\StringTok{  }\NormalTok{P_RO}\OperatorTok{*}\KeywordTok{T_OR}\NormalTok{(PAR))}
\NormalTok{\})\}}
\end{Highlighting}
\end{Shaded}

We can check this out by giving some reasonable times:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{Psi_RR}\NormalTok{(PAR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8683408
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{T_RR}\NormalTok{(PAR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.380765
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{T_RR}\NormalTok{(PAR)}\OperatorTok{/-}\KeywordTok{log}\NormalTok{(}\KeywordTok{Psi_RR}\NormalTok{(PAR))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.780798
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(deSolve)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: deSolve
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{MBDETES_R2R_ODE =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(t,X,P)\{}\KeywordTok{with}\NormalTok{(}\KeywordTok{as.list}\NormalTok{(}\KeywordTok{c}\NormalTok{(P,X)),\{}
\NormalTok{  dR =}\StringTok{ }\OperatorTok{-}\NormalTok{R}\OperatorTok{/}\NormalTok{tR}
\NormalTok{  dL =}\StringTok{ }\NormalTok{P_RL}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OL}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_LL)}\OperatorTok{*}\NormalTok{L}\OperatorTok{/}\NormalTok{tL}
\NormalTok{  dO =}\StringTok{ }\NormalTok{P_RO}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_LO}\OperatorTok{*}\NormalTok{L}\OperatorTok{/}\NormalTok{tL }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_OO)}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO}
\NormalTok{  dF =}\StringTok{ }\NormalTok{P_RF}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OF}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_BF}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_FF)}\OperatorTok{*}\NormalTok{FF}\OperatorTok{/}\NormalTok{tF}
\NormalTok{  dB =}\StringTok{ }\NormalTok{P_RB}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OB}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_FB}\OperatorTok{*}\NormalTok{FF}\OperatorTok{/}\NormalTok{tF }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_BB)}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB}
\NormalTok{  dR2 =}\StringTok{ }\NormalTok{P_BR}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB}
\NormalTok{  dD  =}\StringTok{ }\NormalTok{P_LD}\OperatorTok{*}\NormalTok{L}\OperatorTok{/}\NormalTok{tL }\OperatorTok{+}\StringTok{ }\NormalTok{P_OD}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_FD}\OperatorTok{*}\NormalTok{FF}\OperatorTok{/}\NormalTok{tF }\OperatorTok{+}\StringTok{ }\NormalTok{P_FD}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB }\OperatorTok{+}\StringTok{ }\NormalTok{P_RD}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR}
  \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(dR,dL,dO,dF,dB,dR2))}
\NormalTok{\})\}}

\NormalTok{MBDETES_R2R_solve =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR, }\DataTypeTok{mxT=}\DecValTok{20}\NormalTok{, }\DataTypeTok{dt=}\FloatTok{0.001}\NormalTok{)\{}
\NormalTok{  inits =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DataTypeTok{R=}\DecValTok{1}\NormalTok{,}\DataTypeTok{L=}\DecValTok{0}\NormalTok{,}\DataTypeTok{O=}\DecValTok{0}\NormalTok{,}\DataTypeTok{FF=}\DecValTok{0}\NormalTok{,}\DataTypeTok{B=}\DecValTok{0}\NormalTok{,}\DataTypeTok{R2=}\DecValTok{0}\NormalTok{)}
\NormalTok{  tm =}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,mxT,}\DataTypeTok{by=}\NormalTok{dt)}
  \KeywordTok{data.frame}\NormalTok{(}\KeywordTok{lsoda}\NormalTok{(inits,tm,MBDETES_R2R_ODE,PAR,}\DataTypeTok{atol=}\FloatTok{1e-10}\NormalTok{))}
\NormalTok{\}}
\NormalTok{R2R=}\KeywordTok{MBDETES_R2R_solve}\NormalTok{(PAR)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R2=R2R[,}\DecValTok{7}\NormalTok{]}
\NormalTok{tt=R2R[,}\DecValTok{1}\NormalTok{]}
\NormalTok{highSum=}\KeywordTok{sum}\NormalTok{(}\KeywordTok{diff}\NormalTok{(R2)}\OperatorTok{*}\NormalTok{tt[}\OperatorTok{-}\DecValTok{1}\NormalTok{])}\OperatorTok{/}\KeywordTok{max}\NormalTok{(R2)}
\NormalTok{lowSum=}\KeywordTok{sum}\NormalTok{(}\KeywordTok{diff}\NormalTok{(R2)}\OperatorTok{*}\NormalTok{tt[}\OperatorTok{-}\KeywordTok{length}\NormalTok{(tt)])}\OperatorTok{/}\KeywordTok{max}\NormalTok{(R2)}
\NormalTok{(lowSum}\OperatorTok{+}\NormalTok{highSum)}\OperatorTok{/}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.36951
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R2R_pdf =}\StringTok{ }\KeywordTok{diff}\NormalTok{(R2)}\OperatorTok{/}\KeywordTok{max}\NormalTok{(R2)}
\NormalTok{tt_pdf =}\StringTok{ }\NormalTok{(tt[}\OperatorTok{-}\DecValTok{1}\NormalTok{]}\OperatorTok{+}\NormalTok{tt[}\OperatorTok{-}\KeywordTok{length}\NormalTok{(tt)])}\OperatorTok{/}\DecValTok{2}
\NormalTok{ix =}\StringTok{ }\KeywordTok{which}\NormalTok{(tt_pdf}\OperatorTok{<}\DecValTok{5}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(tt_pdf[ix], R2R_pdf[ix], }\DataTypeTok{type =} \StringTok{"l"}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Time (Days)"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Feeding Cycle Duration"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{states2bionomics_files/figure-latex/unnamed-chunk-17-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{MBDETES_cohort_ODE =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(t,X,P)\{}\KeywordTok{with}\NormalTok{(}\KeywordTok{as.list}\NormalTok{(}\KeywordTok{c}\NormalTok{(P,X)),\{}
\NormalTok{  dF =}\StringTok{ }\NormalTok{P_RF}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OF}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_BF}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_FF)}\OperatorTok{*}\NormalTok{FF}\OperatorTok{/}\NormalTok{tF}
\NormalTok{  dB =}\StringTok{ }\NormalTok{P_RB}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OB}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{+}\StringTok{ }\NormalTok{P_FB}\OperatorTok{*}\NormalTok{FF}\OperatorTok{/}\NormalTok{tF }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_BB)}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB}
\NormalTok{  dR =}\StringTok{ }\NormalTok{P_BR}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB}\OperatorTok{-}\NormalTok{R}\OperatorTok{/}\NormalTok{tR}
\NormalTok{  dL =}\StringTok{ }\NormalTok{P_RL}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_OL}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_LL)}\OperatorTok{*}\NormalTok{L}\OperatorTok{/}\NormalTok{tL}
\NormalTok{  dO =}\StringTok{ }\NormalTok{P_RO}\OperatorTok{*}\NormalTok{R}\OperatorTok{/}\NormalTok{tR }\OperatorTok{+}\StringTok{ }\NormalTok{P_LO}\OperatorTok{*}\NormalTok{L}\OperatorTok{/}\NormalTok{tL }\OperatorTok{-}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{P_OO)}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO}
\NormalTok{  dOO =}\StringTok{ }\NormalTok{(P_OF }\OperatorTok{+}\StringTok{ }\NormalTok{P_OB)}\OperatorTok{*}\NormalTok{O}\OperatorTok{/}\NormalTok{tO}
\NormalTok{  dRR =}\StringTok{ }\NormalTok{P_BR}\OperatorTok{*}\NormalTok{B}\OperatorTok{/}\NormalTok{tB}
  \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(dF,dB,dR,dL,dO,dOO,dRR))}
\NormalTok{\})\}}

\NormalTok{MBDETES_cohort_solve =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(PAR, }\DataTypeTok{pF=}\DecValTok{1}\NormalTok{, }\DataTypeTok{mxT=}\DecValTok{100}\NormalTok{, }\DataTypeTok{dt=}\FloatTok{0.001}\NormalTok{)\{}
\NormalTok{  inits =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DataTypeTok{FF=}\NormalTok{pF,}\DataTypeTok{B=}\DecValTok{1}\OperatorTok{-}\NormalTok{pF,}\DataTypeTok{R=}\DecValTok{0}\NormalTok{,}\DataTypeTok{L=}\DecValTok{0}\NormalTok{,}\DataTypeTok{O=}\DecValTok{0}\NormalTok{,}\DataTypeTok{OO=}\DecValTok{0}\NormalTok{,}\DataTypeTok{RR=}\DecValTok{0}\NormalTok{)}
\NormalTok{  tm =}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,mxT,}\DataTypeTok{by=}\NormalTok{dt)}
  \KeywordTok{data.frame}\NormalTok{(}\KeywordTok{lsoda}\NormalTok{(inits,tm,MBDETES_cohort_ODE,PAR,}\DataTypeTok{atol=}\FloatTok{1e-10}\NormalTok{))}
\NormalTok{\}}
\NormalTok{cohort=}\KeywordTok{MBDETES_cohort_solve}\NormalTok{(PAR,}\DataTypeTok{pF=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\DataTypeTok{dt=}\FloatTok{0.01}\NormalTok{)}
\NormalTok{tt=cohort[,}\DecValTok{1}\NormalTok{]}
\NormalTok{alive =}\StringTok{ }\KeywordTok{rowSums}\NormalTok{(cohort[,}\DecValTok{2}\OperatorTok{:}\DecValTok{6}\NormalTok{])}
\NormalTok{eggs =}\StringTok{ }\NormalTok{cohort[,}\DecValTok{7}\NormalTok{]}
\NormalTok{bloodmeals =}\StringTok{ }\NormalTok{cohort[,}\DecValTok{8}\NormalTok{]}

\NormalTok{highSum=}\OperatorTok{-}\KeywordTok{sum}\NormalTok{(}\KeywordTok{diff}\NormalTok{(alive)}\OperatorTok{*}\NormalTok{tt[}\OperatorTok{-}\DecValTok{1}\NormalTok{])}
\NormalTok{lowSum=}\OperatorTok{-}\KeywordTok{sum}\NormalTok{(}\KeywordTok{diff}\NormalTok{(alive)}\OperatorTok{*}\NormalTok{tt[}\OperatorTok{-}\KeywordTok{length}\NormalTok{(tt)])}
\NormalTok{(lowSum}\OperatorTok{+}\NormalTok{highSum)}\OperatorTok{/}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.85025
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{), }\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(tt, alive, }\DataTypeTok{type =} \StringTok{"l"}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Age (days)"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Surviving"}\NormalTok{)}
\CommentTok{#lines(tt, exp(-tt/9.78), col = "red")}
\KeywordTok{plot}\NormalTok{(tt[}\OperatorTok{-}\DecValTok{1}\NormalTok{], }\KeywordTok{diff}\NormalTok{(eggs), }\DataTypeTok{col =} \StringTok{"blue"}\NormalTok{, }\DataTypeTok{type =} \StringTok{"l"}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Age (days)"}\NormalTok{, }\DataTypeTok{ylab=} \StringTok{"Laying Rate"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(tt[}\OperatorTok{-}\DecValTok{1}\NormalTok{], }\KeywordTok{diff}\NormalTok{(bloodmeals), }\DataTypeTok{col =} \StringTok{"red"}\NormalTok{, }\DataTypeTok{type =} \StringTok{"l"}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Age (days)"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Feeding Rate"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(tt_pdf[ix], R2R_pdf[ix], }\DataTypeTok{type =} \StringTok{"l"}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Time (days)"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Feeding Cycle Length"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{states2bionomics_files/figure-latex/unnamed-chunk-19-1.pdf}


\end{document}
